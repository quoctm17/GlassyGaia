---
description:
globs:
alwaysApply: false
---
# ðŸ”’ Safe Code Generation (v2)
Äáº£m báº£o **zero data loss** trong má»i thao tÃ¡c chá»‰nh sá»­a file.

## ðŸ”¥ Golden Rule: R-M-W-V
```yaml
1. READ:   100% context via read_file
2. MODIFY: chá»n strategy (patch vs overwrite)
3. WRITE:  edit_file vá»›i explanation rÃµ rÃ ng
4. VERIFY: Ä‘á»c láº¡i ngay Ä‘á»ƒ confirm
```

## âš™ï¸ Strategy Selection
```yaml
Simple Patch (â‰¤20% file change):
- Use: // ... existing code ... comments
- Context: 3-5 lines before/after
- Good for: single line fixes, imports

Total Overwrite (>20% change):
- Mandatory for: YAML, JSON, Markdown
- Create complete new content
- Good for: config files, multiple sections
```

## ðŸš¨ High-Risk Files  
LuÃ´n dÃ¹ng **Total Overwrite**:
- `package.json`, `tsconfig.json`
- `.yml`, `.yaml` files  
- Markdown vá»›i tables/code blocks
- Files >500 lines

## ðŸ”„ Error Recovery
```yaml
Corruption detected:
1. Stop immediately
2. Announce issue to user  
3. Switch to total overwrite
4. Verify again
5. Max 2 retry attempts
```

## âœ… Verification Checklist
- [ ] Content matches intended changes
- [ ] No missing sections
- [ ] Formatting preserved
- [ ] File structure intact
- [ ] All imports/references valid

## ðŸ“‹ Best Practices
- Prefer overwrite for complex changes
- Always verify immediately after edit
- Report issues transparently  
- Never assume edit success without verification
